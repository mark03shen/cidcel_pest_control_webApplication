{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Admin Dashboard</title>
</head>
<body>
  <div class="sidebar" id="sidebar">
    <button class="close-sidebar" onclick="toggleSidebar()">‚Üê</button>
    <a href="{% url 'analytics' %}">Analytics</a>
    <a href="{% url 'pest_activity' %}">Pest Activity</a>
    <a href="{% url 'sales' %}">sales</a>
    <a href="{% url 'reports' %}">Reports</a>
  </div>

  <div class="header">
    <button class="menu-btn" onclick="toggleSidebar()">‚ò∞</button>
    <div class="header-nav">
      <a href="{% url 'admin_home' %}">Home</a>
      <a href="{% url 'appointment' %}">Appointment</a>
      <a href="{% url 'customers' %}">Customers</a>
      <a href="{% url 'inventory' %}">Inventory</a>
    </div>

    <div style="position: relative;">
      <button onclick="toggleNotificationModal()" style="position: relative; background: none; border: none; color: white;">
        üîî
        {% if notifications|length > 0  %}
        <span id="notificationBadge" class="notification-badge">
          {{ notifications|length }}
        </span>
        {% endif %}
      </button>
    </div>
    
    <form action="{% url 'logout' %}" method="post" style="margin: 0;">
      {% csrf_token %}
      <button class="logout-btn">Logout</button>
    </form>
  </div>

  <!-- for crud matrix of appointment -->
  <div class="main" id="mainContent">
    <h2>Manage customer service appointments</h2>

    {% if appointments %}
    <div class="bubble-container">
      {% for appointment in appointments %}
      <div class="appointment-bubble">
        <div class="bubble-content">
          <p><strong>Client:</strong> {{ appointment.client_name }}</p>
          <p><strong>Service:</strong> {{ appointment.service }}</p>
          <p><strong>Date:</strong> {{ appointment.date }} at {{ appointment.time }}</p>
        </div>

        <div class="bubble-actions">
          <button onclick="viewAppointment({
            client_name: '{{ appointment.client_name }}',
            service: '{{ appointment.service }}',
            land_use_category: '{{ appointment.land_use_category }}',
            date: '{{ appointment.date }}',
            time: '{{ appointment.time }}',
            job_location: '{{ appointment.job_location }}',
            payment_method: '{{ appointment.payment_method }}',
            total_area: '{{ appointment.total_area }}',
            contract_period: '{{ appointment.contract_period }}',
            estimated_price: '{{ appointment.estimated_price }}',
            mobile: '{{ appointment.mobile }}',
            email: '{{ appointment.email }}',
            client_address: '{{ appointment.client_address }}',
            municipality: '{{ appointment.municipality }}',
            barangay: '{{ appointment.barangay }}',
            street: '{{ appointment.street }}',
            house_number: '{{ appointment.house_number }}'
          })">View</button>

          {% if appointment.verification_assignments.exists %}
            <button style="background-color: gray;" disabled>Assigned</button>
          {% else %}
            <button type="button" onclick="assignTechnician('{{ appointment.id }}')">Assign Technician</button>
          {% endif %}
          <button type="button" onclick="viewProgress('{{ appointment.id }}')">Views Progress</button>

          <!-- ‚úÖ Show Status Only -->
          <div class="appointment-status">
            <strong>Status:</strong> {{ appointment.status }}
          </div>

        </div>

      </div>
      {% endfor %}
    </div>
    {% else %}
      <p>No appointments found.</p>
    {% endif %}
  </div>

  <!-- Progress Modal (updated) -->
  <div id="progressModal" class="progress-modal-overlay" style="display:none;">
    <div class="progress-modal-box">
      <h3>Appointment Progress</h3>

      <!-- Progress tracker container (steps injected by JS) -->
      <div id="viewProgressTracker" class="progress-tracker">
        <!-- steps inserted here by JS -->
      </div>

      <!-- Optional: show progress notes / photos list -->
      <h4 style="margin-top: 25px;">Photo History</h4>
      <div id="progressPhotos" class="photo-gallery">
        <!-- JS will insert photos here -->
      </div>

      <button onclick="closeProgressModal()">Close</button>
    </div>
  </div>



  <!-- View Modal -->
  <div id="viewModal" style="
    display: none; 
    position: fixed; 
    top: 0; 
    left: 0; 
    width: 100vw; 
    height: 100vh; 
    background: rgba(0, 0, 0, 0.5); 
    z-index: 1000;
    overflow-y: auto;  /* Enables scroll when zoomed in */
    padding: 20px;
    box-sizing: border-box;
  ">
    <div style="
      background: #fff; 
      padding: 20px; 
      margin: auto; 
      width: 100%; 
      max-width: 600px; 
      border-radius: 8px; 
      position: relative;
      box-sizing: border-box;
    ">
      <h3>Appointment Details</h3>
      <div id="modalContent" style="margin-top: 10px;"></div>
      <button onclick="closeModal()" style="margin-top: 20px;">Close</button>
    </div>
  </div>

  <!-- Technician Assign Modal -->
  <div id="assignModal" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background: rgba(0,0,0,0.5); z-index:1000;">
    <div style="background:#fff; padding:20px; margin:10% auto; width:90%; max-width:500px; border-radius:8px; position:relative;">
      <h3>Assign Technician</h3>
      <form id="assignForm">
        <input type="hidden" id="assignAppointmentId">
        <label for="technicianSelect">Select Technician:</label>
        <select id="technicianSelect" required></select>
        <br><br>
        <button type="submit">Assign</button>
        <button type="button" onclick="closeAssignModal()">Cancel</button>
      </form>
    </div>
  </div>

  <!-- Admin Notification Modal -->
  <div id="notificationModal" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background: rgba(0,0,0,0.5); z-index:1000;">
    <div style="background:#fff; padding:20px; margin:5% auto; width:90%; max-width:700px; border-radius:8px; position:relative;">

      <h2 style="text-align:center;">Notifications</h2>

      <!-- üîò Filter Buttons -->
      <div style="text-align:center; margin-bottom:15px;">
        <button class="notif-tab active" onclick="showNotifTab('all')">All</button>
        <button class="notif-tab" onclick="showNotifTab('tech')">Technician</button>
        <button class="notif-tab" onclick="showNotifTab('cust')">Customer</button>
      </div>

      <!-- All Notifications -->
      <div id="notif-all" class="notif-section">
        <h3>All Notifications</h3>
        <hr>
        <ul style="list-style:none; padding:0; max-height:300px; overflow-y:auto;">
          {% for note in notifications %}
            <li onclick="showNotificationDetail({{ note.id }})" style="border-bottom: 1px solid #ccc; padding: 10px 0; cursor: pointer;">
              <strong>{{ note.technician.username }}</strong>: {{ note.message }}<br>
              {% if note.appointment %}
                <span><strong>Client Email:</strong> {{ note.appointment.email }}</span><br>
                <span><strong>Client Mobile:</strong> {{ note.appointment.mobile }}</span><br>
              {% endif %}
              <small>{{ note.timestamp|date:"M d, Y H:i" }}</small>
            </li>
          {% endfor %}
          {% for cnote in customer_notifications %}
            <li style="border-bottom: 1px solid #ccc; padding: 10px 0;">
              <strong>{{ cnote.client_name }}</strong> booked an appointment<br>
              <span><strong>Service:</strong> {{ cnote.appointment.service }}</span><br>
              <span><strong>Date:</strong> {{ cnote.appointment.date }}</span>  
              <span><strong>Time:</strong> {{ cnote.appointment.time }}</span><br>
              <span><strong>Email:</strong> {{ cnote.appointment.email }}</span><br>
              <span><strong>Mobile:</strong> {{ cnote.appointment.mobile }}</span><br>
              <small>{{ cnote.timestamp|date:"M d, Y H:i" }}</small>
            </li>
          {% endfor %}
        </ul>
      </div>

      <!-- Technician Notifications Only -->
      <div id="notif-tech" class="notif-section" style="display:none;">
        <h3>Technician Notifications</h3>
        <hr>
        <ul style="list-style:none; padding:0; max-height:300px; overflow-y:auto;">
          {% for note in notifications %}
            <li onclick="showNotificationDetail({{ note.id }})" style="border-bottom: 1px solid #ccc; padding: 10px 0; cursor: pointer;">
              <strong>{{ note.technician.username }}</strong>: {{ note.message }}<br>
              <small>{{ note.timestamp|date:"M d, Y H:i" }}</small>
            </li>
          {% empty %}
            <li>No technician notifications found.</li>
          {% endfor %}
        </ul>
      </div>

      <!-- Customer Notifications Only -->
      <div id="notif-cust" class="notif-section" style="display:none;">
        <h3>Customer Notifications</h3>
        <hr>
        <ul style="list-style:none; padding:0; max-height:300px; overflow-y:auto;">
          {% for cnote in customer_notifications %}
            <li style="border-bottom: 1px solid #ccc; padding: 10px 0;">
              <strong>{{ cnote.client_name }}</strong> booked an appointment<br>
              <span><strong>Service:</strong> {{ cnote.appointment.service }}</span><br>
              <small>{{ cnote.timestamp|date:"M d, Y H:i" }}</small>
            </li>
          {% empty %}
            <li>No customer notifications.</li>
          {% endfor %}
        </ul>
      </div>

      <button onclick="closeNotificationModal()" style="margin-top: 20px;">Close</button>
    </div>
  </div>


  <!-- Single Notification Detail Modal -->
  <div id="notificationDetailModal" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background: rgba(0,0,0,0.5); z-index:1000;">
    <div style="background:#fff; padding:20px; margin:10% auto; width:90%; max-width:600px; border-radius:8px; position:relative;">
      <h3>Notification Details</h3>
      <div id="notificationDetailContent"></div>
      <button onclick="closeNotificationDetail()" style="margin-top: 20px;">Close</button>
      <!--for sending SMS-->
      <div id="notificationDetailContent"></div>
      {% comment %} <button onclick="sendSmsConfirmation()" style="background-color: green; color: white;">Send SMS Confirmation</button> {% endcomment %}
      <!--for sending SMS-->
    </div>
  </div>
  


<script>
function toggleSidebar() {
  document.getElementById('sidebar').classList.toggle('hidden');
  document.getElementById('mainContent').classList.toggle('full');
}

function viewAppointment(data) {
  const content = `
    <p><strong>Client Name:</strong> ${data.client_name}</p>
    <p><strong>Service:</strong> ${data.service}</p>
    <p><strong>Land Use Category:</strong> ${data.land_use_category}</p>
    <p><strong>Contract Period:</strong> ${data.contract_period}</p>
    <p><strong>Price:</strong> ${data.estimated_price}</p>
    <p><strong>Total Area:</strong> ${data.total_area} sqm</p>
    <p><strong>Date:</strong> ${data.date}</p>
    <p><strong>Time:</strong> ${data.time}</p>
    <p><strong>Job Location:</strong> ${data.job_location}</p>
    <p><strong>Payment Method:</strong> ${data.payment_method}</p>
    <p><strong>Client Address:</strong> ${data.client_address}</p>
    <p><strong>Municipality:</strong> ${data.municipality}</p>
    <p><strong>Barangay:</strong> ${data.barangay}</p>
    <p><strong>Street:</strong> ${data.street}</p>
    <p><strong>House No.:</strong> ${data.house_number}</p>
    <p><strong>Mobile:</strong> ${data.mobile}</p>
    <p><strong>Email:</strong> ${data.email}</p>
  `;
  document.getElementById('modalContent').innerHTML = content;
  document.getElementById('viewModal').style.display = 'block';
}


function closeModal() {
  document.getElementById('viewModal').style.display = 'none';
}

// for the PROGRESS modal
// --- helper to open progress modal and load steps from backend ---
function viewProgress(appointmentId) {
  // show modal immediately (helps for UX)
  document.getElementById("progressModal").style.display = "block";

  // fetch step list + current status for this appointment
  fetch(`/get-progress-steps/?appointment_id=${appointmentId}`)
    .then(resp => resp.json())
    .then(data => {
      if (!data.success) {
        // show error inside modal
        document.getElementById("viewProgressTracker").innerHTML =
          `<p style="color:red;">No progress available: ${data.error || 'unknown'}</p>`;
        return;
      }

      const steps = data.steps || [];
      const currentStatus = data.current_status;

      // render steps into DOM
      const tracker = document.getElementById("viewProgressTracker");
      tracker.innerHTML = ""; // clear

      steps.forEach(step => {
        const stepHTML = `
          <div class="step" data-step="${step}">
            <span class="dot">
              <svg class="checkmark" viewBox="0 0 24 24">
                <path d="M4 12l6 6 10-14" stroke-width="3" fill="none"/>
              </svg>
            </span>
            <p>${step}</p>
          </div>
        `;
        tracker.insertAdjacentHTML('beforeend', stepHTML);
      });

      // animate and set completed classes
      updateAppointmentProgressBar(currentStatus, "viewProgressTracker");

      // optional: load photo history or TechnicianProgress entries if you want later
      // fetch(`/get-progress-history/?appointment_id=${appointmentId}`)
      //   .then(r => r.json()).then(historyData => { ... })
    })
    .catch(err => {
      console.error("Error fetching progress:", err);
      document.getElementById("viewProgressTracker").innerHTML =
        `<p style="color:red;">Failed to load progress.</p>`;
    });

  // Load photo history
  fetch(`/get-progress-photos/?appointment_id=${appointmentId}`)
    .then(resp => resp.json())
    .then(data => {
      const container = document.getElementById("progressPhotos");
      container.innerHTML = "";

      if (!data.success || data.photos.length === 0) {
        container.innerHTML = "<p style='color:#666;'>No photos uploaded yet.</p>";
        return;
      }

      data.photos.forEach(photo => {
        const html = `
          <div class="photo-item">
            <img src="${photo.image_url}" alt="Progress Photo">

            <div class="photo-labels">
              <span class="photo-status">${photo.status_label}</span>
              <span class="photo-tech">By: ${photo.technician}</span>
            </div>

            <small>${photo.timestamp}</small>
          </div>
        `;
        container.insertAdjacentHTML("beforeend", html);
      });
    });
}

function closeProgressModal() {
  document.getElementById("progressModal").style.display = "none";
}

// progress photo



// Update progress UI for given trackerId (default to #viewProgressTracker)
function updateAppointmentProgressBar(currentStatus, trackerId = "viewProgressTracker") {
    const tracker = document.getElementById(trackerId);
    if (!tracker) return;

    const steps = Array.from(tracker.querySelectorAll(".step"));

    // If technician has NOT updated progress yet
    if (!currentStatus) {
        tracker.style.setProperty("--line-fill", "0%");
        steps.forEach(step => {
            step.classList.remove("completed");
            step.classList.remove("active");
        });
        return;
    }

    // If technician updated, determine correct step index
    const currentIndex = steps.findIndex(s => s.dataset.step === currentStatus);

    if (currentIndex === -1) return;

    const totalSteps = steps.length - 1;
    const fillPercent = (currentIndex / totalSteps) * 100;

    tracker.style.setProperty("--line-fill", fillPercent + "%");

    steps.forEach((step, idx) => {
        if (idx < currentIndex) {
            step.classList.add("completed");
        } else if (idx === currentIndex) {
            step.classList.add("completed");
            step.classList.add("active");
        } else {
            step.classList.remove("completed");
            step.classList.remove("active");
        }
    });
}


// close modal when clicking outside (nice UX)
window.addEventListener('click', function(e) {
  const modal = document.getElementById('progressModal');
  if (modal && e.target === modal) {
    closeProgressModal();
  }
});


//---- for assigning Technician
function assignTechnician(appointmentId) {
  document.getElementById('assignAppointmentId').value = appointmentId;

  // Fetch technicians
  fetch('/get-technicians/')
    .then(res => res.json())
    .then(data => {
      const select = document.getElementById('technicianSelect');
      select.innerHTML = '';

      data.technicians.forEach(tech => {
        const option = document.createElement('option');
        option.value = tech.id;
        //option.textContent = tech.username;
        // Add online/offline dot using emoji or Unicode circle
        const statusDot = tech.online ? 'üü¢' : 'üî¥';
        option.textContent = `${tech.username} ${statusDot}`;
        
        select.appendChild(option);
      });

      document.getElementById('assignModal').style.display = 'block';
    });
} 

setInterval(refreshTechnicians, 3000);
//---- MERGED assignTechnician FUNCTION ----//


function closeAssignModal() {
  document.getElementById('assignModal').style.display = 'none';
}

document.getElementById('assignForm').addEventListener('submit', function (e) {
  e.preventDefault();

  const appointmentId = document.getElementById('assignAppointmentId').value;
  const technicianId = document.getElementById('technicianSelect').value;

  fetch('/assign-verification/', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/x-www-form-urlencoded',
      'X-CSRFToken': '{{ csrf_token }}'
    },
    body: `appointment_id=${appointmentId}&technician_id=${technicianId}`
  })
  .then(response => response.json())
  .then(data => {
    if (data.success) {
      alert(data.status === 'assigned' ? 'Technician assigned!' : 'Already assigned.');

      // üîÑ Change the button to "Assigned" and disable it
      const rowBtn = document.querySelector(`button[onclick="assignTechnician('${appointmentId}')"]`);
      if (rowBtn) {
        rowBtn.textContent = 'Assigned';
        rowBtn.disabled = true;
      }

      closeAssignModal();
    } else {
      alert('Failed to assign: ' + data.error);
    }
  });
});

//--- for admin notification modal
function toggleNotificationModal() {
  const modal = document.getElementById('notificationModal');
  modal.style.display = 'block';
}

function closeNotificationModal() {
  document.getElementById('notificationModal').style.display = 'none';
}

// Optional: Close modal when clicking outside of it
window.addEventListener('click', function(e) {
  const modal = document.getElementById('notificationModal');
  if (e.target === modal) {
    modal.style.display = 'none';
  }
});

//--- for  single notification modal
function showNotificationDetail(notifId) {
  fetch(`/get-notification-detail/?id=${notifId}`)
    .then(response => response.json())
    .then(data => {
      const content = `
        <p><strong>Technician:</strong> ${data.technician}</p>
        <p><strong>Message:</strong> ${data.message}</p>
        
        <hr>
        ${data.client_name ? `
          <p><strong>Client:</strong> ${data.client_name}</p>
          <p><strong>Service:</strong> ${data.service}</p>
          <p><strong>Date:</strong> ${data.date}</p>
          <p><strong>Time:</strong> ${data.time}</p>
          <p><strong>Email:</strong> ${data.email}</p>
          <p><strong>Mobile:</strong> ${data.mobile}</p>
        ` : '<p>No appointment linked.</p>'}
      `;
      document.getElementById('notificationDetailContent').innerHTML = content;
      document.getElementById('notificationDetailModal').style.display = 'block';
    });
}

function closeNotificationDetail() {
  document.getElementById('notificationDetailModal').style.display = 'none';
}


//--- for status update functions
function updateAppointmentStatus(assignmentId, status) {
  fetch("{% url 'update_verification_status' %}", {
    method: "POST",
    headers: {
      "X-CSRFToken": "{{ csrf_token }}",
      "Content-Type": "application/x-www-form-urlencoded"
    },
    body: new URLSearchParams({
      assignment_id: assignmentId,
      status: status
    })
  })
  .then(response => response.json())
  .then(data => {
    if (data.success) {
      console.log("‚úÖ Status updated:", status);
    } else {
      alert("‚ùå Error: " + (data.error || "Failed to update"));
    }
  })
  .catch(err => {
    console.error("AJAX error:", err);
  });
}

function showNotifTab(tab) {
  // Hide all sections
  document.querySelectorAll('.notif-section').forEach(s => s.style.display = 'none');

  // Remove active state from all buttons
  document.querySelectorAll('.notif-tab').forEach(btn => btn.classList.remove('active'));

  // Show selected section
  if (tab === 'all') {
    document.getElementById('notif-all').style.display = 'block';
    document.querySelector(".notif-tab:nth-child(1)").classList.add('active');
  } 
  else if (tab === 'tech') {
    document.getElementById('notif-tech').style.display = 'block';
    document.querySelector(".notif-tab:nth-child(2)").classList.add('active');
  } 
  else if (tab === 'cust') {
    document.getElementById('notif-cust').style.display = 'block';
    document.querySelector(".notif-tab:nth-child(3)").classList.add('active');
  }
}

</script>


</body>
<style>
  body { 
    margin: 0; 
    font-family: Arial, 
    sans-serif; 
  }
  /* Sticky Header */
  .header {
    position: sticky;
    top: 0;
    z-index: 999;
    background: #010A28;
    color: white;
    padding: 10px 20px;
    display: flex;
    justify-content: space-between;
    align-items: center;
  }
  .menu-btn, .logout-btn {
    background: none; 
    border: none; 
    color: white; 
    font-size: 16px; 
    cursor: pointer;
  }
  .sidebar {
    width: 250px; 
    background: #010A28; 
    height: 100vh; 
    position: fixed;
    top: 0; 
    left: 0;
    padding-top: 60px; 
    transform: translateX(0); 
    transition: transform 0.3s ease;
  }
  .sidebar.hidden { 
    transform: translateX(-100%); 
  }
  .sidebar a {
    display: block; 
    padding: 15px 20px; 
    color: white; 
    text-decoration: none;
  }
  .sidebar a:hover { 
    background: #2c3e50;
  }

  @media (max-width: 768px) {
    .main {
      margin-left: 0;
    }
    .sidebar {
      position: fixed;
      height: 100%;
      z-index: 998;
    }
  }

  .close-sidebar {
    position: absolute; 
    top: 10px; 
    right: 10px; 
    background: none; 
    border: none; 
    color: white;
    font-size: 20px; 
    cursor: pointer;
  }
  .main {
    margin-left: 250px; 
    padding: 20px;
    transition: margin-left 0.3s ease;
  }
  .main.full { 
    margin-left: 0; 
  }
  .header-nav a {
    margin-left: 20px; 
    color: white; 
    text-decoration: none;
  }

/* for table */
table {
  border-collapse: collapse;
}
th, td {
  padding: 10px;
}
button {
  padding: 5px 10px;
  background-color: #010A28;
  color: white;
  border: none;
  border-radius: 4px;
  cursor: pointer;
}
button:hover {
  background-color: #002060;
}

.notification-badge {
  position: absolute;
  top: -5px;
  right: -10px;
  background: red;
  color: white;
  border-radius: 50%;
  padding: 2px 6px;
  font-size: 12px;
  font-weight: bold;
}

/* for bubble appointment css*/
/* Bubble Layout */
.bubble-container {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
  gap: 20px;
  margin-top: 20px;
}

.appointment-bubble {
  background: #CBDCEB;
  border-radius: 20px;
  padding: 20px;
  box-shadow: 0 4px 12px rgba(0,0,0,0.1);
  transition: transform 0.2s ease;
}

.appointment-bubble:hover {
  transform: translateY(-5px);
}

.bubble-content p {
  margin: 6px 0;
  font-size: 0.95em;
  color: #333;
}

.bubble-actions {
  margin-top: 12px;
  display: flex;
  flex-wrap: wrap;
  gap: 10px;
}

.bubble-actions button {
  flex: 1;
  padding: 8px 12px;
  border: none;
  border-radius: 12px;
  cursor: pointer;
  font-size: 0.9em;
  transition: background 0.2s ease;
}

.bubble-actions button:hover {
  background-color: #002060;
}

/* Notification Tabs */
.notif-tab {
  padding: 10px 15px;
  margin: 5px;
  border: none;
  background: #eee;
  cursor: pointer;
  border-radius: 8px;
  font-weight: bold;
  color: #DDAA1E;
}

.notif-tab.active {
  background: #010A28;
  color: white;
}

/* === Progress Modal CSS === */
.progress-modal-overlay {
  display: none;
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0,0,0,0.5);
  z-index: 1000;
}

.progress-modal-box {
  background: #fff;
  padding: 20px;
  margin: 10% auto;
  width: 90%;
  max-width: 500px;
  border-radius: 8px;
  position: relative;
  box-shadow: 0 4px 10px rgba(0,0,0,0.3);
}

.progress-modal-box h3 {
  margin-top: 0;
}

.progress-modal-box button {
  margin-top: 20px;
  padding: 8px 12px;
  background-color: #010A28;
  color: white;
  border: none;
  border-radius: 6px;
  cursor: pointer;
}

.progress-modal-box button:hover {
  background-color: #002060;
}

/* progress tracker (same styles as your verification_route) */
.progress-tracker {
  margin-top: 15px;
  display: flex;
  justify-content: space-between;
  position: relative;
  --line-fill: 0%;
}

.progress-tracker::before {
  content: "";
  position: absolute;
  top: 8px;
  left: 0;
  right: 0;
  height: 4px;
  background: #d8d8d8;
  z-index: 1;
}

.progress-tracker::after {
  content: "";
  position: absolute;
  top: 8px;
  left: 0;
  height: 3px;
  background: #6D94C5;
  width: var(--line-fill);
  transition: width 0.4s ease;
  z-index: 2;
}

.step {
  text-align: center;
  font-size: 0.95em;
  width: 100%;
  position: relative;
  z-index: 3;
}

.step .dot {
  width: 20px;
  height: 20px;
  display: block;
  margin: 0 auto;
  border-radius: 50%;
  background: #cfcfcf;
  border: 2px solid #cfcfcf;
  position: relative;
  transition: 0.3s ease;
}

.step.completed .dot {
  background: #6D94C5;
  border-color: #6D94C5;
}

.step.active .dot {
  background: #6D94C5;
  border-color: #6D94C5;
  box-shadow: 0 0 8px rgba(16,85,201,0.6);
}

.checkmark {
  width: 18px;
  height: 18px;
  stroke: white;
  opacity: 0;
  transform: scale(0);
  transform-origin: center;
  transition: all 0.25s ease-out;
}

.step.completed .checkmark {
  opacity: 1;
  transform: scale(1.1);
}
.step p { margin-top:6px; font-size:0.75em; color:#333;}

/*========*/
.photo-gallery {
  margin-top: 15px;
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
  gap: 12px;
}

.photo-item {
  background: #f5f5f5;
  border-radius: 8px;
  padding: 6px;
  text-align: center;
  box-shadow: 0 2px 6px rgba(0,0,0,0.1);
}

.photo-item img {
  width: 50%;
  border-radius: 6px;
}

.photo-item small {
  display: block;
  margin-top: 5px;
  font-size: 12px;
  color: #555;
}

.photo-labels {
  margin-top: 6px;
}

.photo-status {
  display: inline-block;
  background: #010A28;
  color: white;
  padding: 2px 6px;
  border-radius: 5px;
  font-size: 11px;
  margin-right: 5px;
}

.photo-tech {
  display: inline-block;
  background: #ddd;
  color: #333;
  padding: 2px 6px;
  border-radius: 5px;
  font-size: 11px;
}

</style>
</html>